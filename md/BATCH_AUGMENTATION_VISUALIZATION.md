# ğŸ¨ Batch Augmentation: Visual Guide

## ğŸ² The `prob` Parameter in Action

### Batch Processing with prob=0.5

```
Input Batch (8 samples):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Sample 0â”‚Sample 1â”‚Sample 2â”‚Sample 3â”‚Sample 4â”‚Sample 5â”‚Sample 6â”‚Sample 7â”‚
â”‚ Clean  â”‚ Clean  â”‚ Clean  â”‚ Clean  â”‚ Clean  â”‚ Clean  â”‚ Clean  â”‚ Clean  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“        â†“        â†“        â†“        â†“        â†“        â†“        â†“
  rand()   rand()   rand()   rand()   rand()   rand()   rand()   rand()
   0.23     0.67     0.45     0.89     0.12     0.78     0.34     0.91
    â†“        â†“        â†“        â†“        â†“        â†“        â†“        â†“
  <0.5?    >0.5?    <0.5?    >0.5?    <0.5?    >0.5?    <0.5?    >0.5?
   YES       NO      YES       NO      YES       NO      YES       NO
    â†“        â†“        â†“        â†“        â†“        â†“        â†“        â†“
  AUGMENT  SKIP    AUGMENT   SKIP    AUGMENT   SKIP   AUGMENT   SKIP

Output Batch:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Sample 0â”‚Sample 1â”‚Sample 2â”‚Sample 3â”‚Sample 4â”‚Sample 5â”‚Sample 6â”‚Sample 7â”‚
â”‚ Noisy  â”‚ Clean  â”‚ Noisy  â”‚ Clean  â”‚ Noisy  â”‚ Clean  â”‚ Noisy  â”‚ Clean  â”‚
â”‚  ğŸ”ŠğŸ¤  â”‚   ğŸ¤   â”‚  ğŸ”ŠğŸ¤  â”‚   ğŸ¤   â”‚  ğŸ”ŠğŸ¤  â”‚   ğŸ¤   â”‚  ğŸ”ŠğŸ¤  â”‚   ğŸ¤   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Result: 4 augmented, 4 clean (50% as expected)
```

---

## ğŸ­ Augmentation Type Selection

### Decision Tree for Each Sample

```
                    Sample Selected for Augmentation
                                 â†“
                         random() < noise_ratio?
                        /                      \
                      YES                       NO
                      /                          \
                     â†“                            â†“
            NOISE AUGMENTATION           SPEECH AUGMENTATION
                     â†“                            â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Use noise_manifest   â”‚      â”‚ Use batch samples    â”‚
         â”‚                      â”‚      â”‚                      â”‚
         â”‚ SNR: [min_r_noise,   â”‚      â”‚ SNR: [min_r_speech,  â”‚
         â”‚       max_r_noise]   â”‚      â”‚       max_r_speech]  â”‚
         â”‚                      â”‚      â”‚                      â”‚
         â”‚ Example:             â”‚      â”‚ Example:             â”‚
         â”‚ [Speech + traffic]   â”‚      â”‚ [Speaker A + B]      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

With noise_ratio=0.5:
    50% of augmented samples â†’ Noise
    50% of augmented samples â†’ Speech
```

---

## ğŸ“Š SNR (Signal-to-Noise Ratio) Explained

### What is SNR?

```
SNR (dB) = 10 * log10(Signal_Power / Noise_Power)

Positive SNR â†’ Signal louder than noise
Zero SNR     â†’ Signal and noise equal
Negative SNR â†’ Noise louder than signal
```

### SNR Scale Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SNR Scale (dB)                           â”‚
â”‚                                                             â”‚
â”‚  -10 dB  â”€â”€â”¼â”€â”€  Noise 10x louder    [Extremely Noisy]     â”‚
â”‚            â”‚                                                â”‚
â”‚   -5 dB  â”€â”€â”¼â”€â”€  Noise 3x louder     [Very Noisy]          â”‚
â”‚            â”‚                                                â”‚
â”‚    0 dB  â”€â”€â”¼â”€â”€  Equal power         [Balanced]            â”‚
â”‚            â”‚                                                â”‚
â”‚   +5 dB  â”€â”€â”¼â”€â”€  Signal 3x louder    [Moderate Noise]      â”‚
â”‚            â”‚                                                â”‚
â”‚  +10 dB  â”€â”€â”¼â”€â”€  Signal 10x louder   [Light Noise]         â”‚
â”‚            â”‚                                                â”‚
â”‚  +20 dB  â”€â”€â”¼â”€â”€  Signal 100x louder  [Very Clean]          â”‚
â”‚            â”‚                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Config Example:
  min_r_noise: -5.0   â†â”
  max_r_noise: 20.0   â†â”¤ Wide range!
                       â””â”€ Model sees all conditions
```

---

## ğŸµ Noise Augmentation Process

### Step-by-Step Visualization

```
Step 1: Original Clean Speech
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Waveform:                                        â”‚
â”‚   â•±â•²  â•±â•²  â•±â•²  â•±â•²  â•±â•²  â•±â•²  â•±â•²  â•±â•²               â”‚
â”‚  â•±  â•²â•±  â•²â•±  â•²â•±  â•²â•±  â•²â•±  â•²â•±  â•²â•±  â•²              â”‚
â”‚                                                  â”‚
â”‚ Duration: 10 seconds                             â”‚
â”‚ Energy: 1.0 (arbitrary units)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 2: Select Noise from noise_manifest
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Noise (traffic sound):                           â”‚
â”‚   â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ â”‚
â”‚                                                  â”‚
â”‚ Duration: 3 seconds (repeated if needed)         â”‚
â”‚ Energy: 0.8                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 3: Determine Mix Parameters
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ mix_rate: 0.5 (from config)                      â”‚
â”‚ mix_len: 10s * 0.5 = 5 seconds                  â”‚
â”‚                                                  â”‚
â”‚ Random position to mix:                          â”‚
â”‚ mix_start_idx: 2 seconds (randomly selected)     â”‚
â”‚                                                  â”‚
â”‚ Mixing window: [2s, 7s]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 4: Calculate SNR and Scale
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Random SNR: 10 dB (from [min_r_noise, max_r_noise])
â”‚                                                  â”‚
â”‚ Calculation:                                     â”‚
â”‚   speech_energy = 1.0                            â”‚
â”‚   noise_energy = 0.8                             â”‚
â”‚   target_ratio = 10^(10/10) = 10                â”‚
â”‚                                                  â”‚
â”‚   scale = sqrt(speech_energy / (target_ratio * noise_energy))
â”‚         = sqrt(1.0 / (10 * 0.8))                â”‚
â”‚         = sqrt(0.125)                            â”‚
â”‚         = 0.354                                  â”‚
â”‚                                                  â”‚
â”‚ Scaled noise is 3.16x quieter than speech!       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 5: Mix Audio
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Timeline (seconds):                              â”‚
â”‚  0    1    2    3    4    5    6    7    8    9  10
â”‚  â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”‚â”€â”€â”‚
â”‚  â”‚         â”‚                   â”‚                 â”‚
â”‚  Clean    Mix Start         Mix End          Clean
â”‚           â”‚â—„â”€â”€â”€â”€â”€ 5s â”€â”€â”€â”€â”€â”€â–ºâ”‚                    â”‚
â”‚                                                  â”‚
â”‚ Final Waveform:                                  â”‚
â”‚   â•±â•²  â•±â•²  â•±â•²â–“â–“â•±â•²â–“â–“â•±â•²â–“â–“â•±â•²â–“â–“â•±â•²  â•±â•²  â•±â•²           â”‚
â”‚  â•±  â•²â•±  â•²â•±â–“â–“â•²â•±â–“â–“â•²â•±â–“â–“â•²â•±â–“â–“â•²â•±  â•²â•±  â•²â•±  â•²          â”‚
â”‚           â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“                     â”‚
â”‚  â””â”€Cleanâ”€â”€â”´â”€â”€â”€Noisy Mixâ”€â”€â”€â”´â”€â”€â”€Cleanâ”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Result: Speech + scaled noise in middle portion
```

---

## ğŸ‘¥ Speech Augmentation Process

### Multi-Speaker Mixing

```
Step 1: Original Speakers in Batch
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Batch of 4 samples:                              â”‚
â”‚                                                  â”‚
â”‚ Sample 0 (Speaker A): "Hello, how are you?"     â”‚
â”‚   â•±â•²  â•±â•²  â•±â•²  â•±â•²  â•±â•²                           â”‚
â”‚  â•±  â•²â•±  â•²â•±  â•²â•±  â•²â•±  â•²                          â”‚
â”‚                                                  â”‚
â”‚ Sample 1 (Speaker B): "I'm doing great!"        â”‚
â”‚   â•±â”€â•²â•±â”€â•²â•±â”€â•²â•±â”€â•²                                 â”‚
â”‚                                                  â”‚
â”‚ Sample 2 (Speaker C): "That's wonderful!"       â”‚
â”‚   â•±â”€â”€â•²â•±â”€â”€â•²â•±â”€â”€â•²                                 â”‚
â”‚                                                  â”‚
â”‚ Sample 3 (Speaker D): "See you later!"          â”‚
â”‚   â•±â”€â”€â”€â•²â•±â”€â”€â”€â•²                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 2: Augment Sample 0 with other speakers
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Augmentation Decision:                           â”‚
â”‚   num_speakers: 1 (randomly selected)            â”‚
â”‚   Selected: Speaker B (Sample 1)                 â”‚
â”‚   num_segments: 1                                â”‚
â”‚   mix_rate: 0.5                                  â”‚
â”‚   SNR: 0 dB (equal volume)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 3: Create Mixed Signal
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Original (Speaker A):                            â”‚
â”‚  Timeline: [Hello, how are you?]                 â”‚
â”‚   â•±â•²  â•±â•²  â•±â•²  â•±â•²  â•±â•²  â•±â•²  â•±â•²                   â”‚
â”‚  â•±  â•²â•±  â•²â•±  â•²â•±  â•²â•±  â•²â•±  â•²â•±  â•²                  â”‚
â”‚  0s   1s   2s   3s   4s   5s   6s                â”‚
â”‚                                                  â”‚
â”‚ Added (Speaker B segment):                       â”‚
â”‚  Position: [2s - 5s]                             â”‚
â”‚             â•±â”€â•²â•±â”€â•²â•±â”€â•²â•±â”€â•²                        â”‚
â”‚  0s   1s   2s   3s   4s   5s   6s                â”‚
â”‚                                                  â”‚
â”‚ Result (A + B):                                  â”‚
â”‚  â•±â•²  â•±â•²  â•±â•²â”€â•²â•±â”€â•²â•±â”€â•²â•±â”€â•²  â•±â•²                     â”‚
â”‚ â•±  â•²â•±  â•²â•± â”¼â•²â”€â•±â”¼â•²â”€â•±â”¼â•²â”€â•± â•²â•±  â•²                   â”‚
â”‚            â”œâ”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”¤                        â”‚
â”‚            Overlapping speech!                   â”‚
â”‚                                                  â”‚
â”‚ Interpretation: "Hello, I'm doing are you?"      â”‚
â”‚                 (overlapped/garbled)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§© Multi-Segment Augmentation

### Example with 3 Segments

```
Config:
  min_num_segments: 3
  max_num_segments: 3
  mix_rate: 0.6

Original Audio (10 seconds):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Speaker A continuously speaking                 â”‚
â”‚  â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²â•±â•²     â”‚
â”‚  0s  1s  2s  3s  4s  5s  6s  7s  8s  9s 10s      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Augmentation Plan:
  Total mix duration: 10s * 0.6 = 6 seconds
  Divide into 3 segments: 2s, 2s, 2s
  Assign speakers: B, C, B

Segment Placement (randomly positioned):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Segment 1 (Speaker B, 2s): Position [1s-3s]    â”‚
â”‚  Segment 2 (Speaker C, 2s): Position [4s-6s]    â”‚
â”‚  Segment 3 (Speaker B, 2s): Position [7s-9s]    â”‚
â”‚                                                  â”‚
â”‚  â•±â•²â•±Bâ•²â•±Bâ•²â•±â•²â•±Câ•²â•±Câ•²â•±â•²â•±Bâ•²â•±Bâ•²â•±â•²                    â”‚
â”‚  0s  1s  2s  3s  4s  5s  6s  7s  8s  9s 10s      â”‚
â”‚  â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜               â”‚
â”‚  Clean B  B  Clean C  C  Clean B  B  Clean       â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Result: 3 separate speaker overlaps at different times
        (Simulates multi-party conversation)
```

---

## ğŸ“ˆ Impact on Training Data Distribution

### Without Augmentation (prob=0.0)

```
Data Distribution:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ All samples are clean speech       â”‚
â”‚                                    â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚
â”‚ 100% Clean                         â”‚
â”‚                                    â”‚
â”‚ Limited robustness to:             â”‚
â”‚   âŒ Noise                         â”‚
â”‚   âŒ Multi-speaker                 â”‚
â”‚   âŒ Real-world conditions         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### With Augmentation (prob=0.5, noise_ratio=0.5)

```
Data Distribution:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  50% Clean        â”‚
â”‚                                    â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  25% Noise-augmented      â”‚
â”‚                                    â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  25% Speech-augmented     â”‚
â”‚                                    â”‚
â”‚ Model learns:                      â”‚
â”‚   âœ… Clean speech                  â”‚
â”‚   âœ… Noisy conditions              â”‚
â”‚   âœ… Multi-speaker scenarios       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### With Aggressive Augmentation (prob=1.0)

```
Data Distribution:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    â”‚
â”‚                  0% Clean          â”‚
â”‚                                    â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚
â”‚ 100% Augmented                     â”‚
â”‚                                    â”‚
â”‚ Maximum robustness, but:           â”‚
â”‚   âš ï¸ May reduce clean performance  â”‚
â”‚   âš ï¸ Longer convergence            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Parameter Interaction Examples

### Example 1: Gentle Augmentation

```yaml
prob: 0.3                    # 30% augmented
noise_ratio: 0.7             # Prefer noise
min_r_noise: 5.0             # Light noise only
max_r_noise: 20.0
min_mix_rate: 0.3
max_mix_rate: 0.5
```

**Visualization:**
```
Batch of 10 samples:
â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
â”‚C â”‚C â”‚N â”‚C â”‚C â”‚C â”‚S â”‚C â”‚C â”‚C â”‚  C=Clean, N=Noise, S=Speech
â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜
 ~3 samples augmented (30%)
 Of those: 2 noise, 1 speech

Noise levels: Light (5-20 dB SNR)
Mix duration: 30-50% of audio
```

### Example 2: Aggressive Multi-Speaker

```yaml
prob: 0.8                    # 80% augmented
noise_ratio: 0.2             # Prefer speakers
min_r_speech: -8.0
max_r_speech: 8.0
min_num_segments: 2
max_num_segments: 4
min_num_speakers: 2
max_num_speakers: 3
```

**Visualization:**
```
Batch of 10 samples:
â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”
â”‚S â”‚S â”‚N â”‚S â”‚S â”‚C â”‚S â”‚S â”‚S â”‚C â”‚  C=Clean, N=Noise, S=Speech
â””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜
 ~8 samples augmented (80%)
 Of those: ~2 noise, ~6 multi-speaker

Multi-speaker details:
  - 2-3 extra speakers per sample
  - 2-4 segments (complex overlaps)
  - Varying SNR (-8 to +8 dB)
```

---

## ğŸ”„ Complete Pipeline Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  SSL Training Pipeline                      â”‚
â”‚                   with Augmentation                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DataLoader: Load batch of clean audio                      â”‚
â”‚    - train_ds.manifest_filepath                             â”‚
â”‚    - noise_manifest (if using noise aug)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  batch_augmentor: MultiSpeakerNoiseAugmentation             â”‚
â”‚                                                             â”‚
â”‚  For each sample:                                           â”‚
â”‚    â”Œâ”€ random() < prob? â”€â”                                  â”‚
â”‚    â”‚    YES         NO   â”‚                                  â”‚
â”‚    â†“                â†“    â”‚                                  â”‚
â”‚  Augment         Keep    â”‚                                  â”‚
â”‚  (noise or     clean     â”‚                                  â”‚
â”‚   speakers)              â”‚                                  â”‚
â”‚                          â”‚                                  â”‚
â”‚  Output: AudioNoiseBatch                                    â”‚
â”‚    - audio: original clean                                  â”‚
â”‚    - noisy_audio: augmented                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  preprocessor: AudioToMelSpectrogramPreprocessor            â”‚
â”‚    Clean features:  preprocessor(audio)                     â”‚
â”‚    Noisy features:  preprocessor(noisy_audio)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  quantizer: Generate targets from CLEAN features            â”‚
â”‚    targets = quantizer(clean_features)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  masking: Apply causal masking to NOISY features            â”‚
â”‚    masked_noisy_features, masks = masking(noisy_features)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  encoder: Process masked noisy features                     â”‚
â”‚    encoded = encoder(masked_noisy_features)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  decoder: Predict tokens                                    â”‚
â”‚    predictions = decoder(encoded)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  loss: Compare predictions to targets (on masked positions) â”‚
â”‚    loss = CrossEntropy(predictions[masked], targets[masked])â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Key Insight:
  - Targets come from CLEAN audio
  - Model sees NOISY + MASKED audio
  - Learns to denoise AND predict masked tokens!
```

---

## ğŸ“Š Expected Behavior

### Training Loss Curves

```
                      Training Loss
                           â”‚
Without Augmentation       â”‚    With Augmentation (prob=0.5)
                           â”‚
Loss                       â”‚                    Loss
  â”‚                        â”‚                      â”‚
  â”‚â•²                       â”‚                      â”‚â•²â•²
  â”‚ â•²                      â”‚                      â”‚  â•²â•²
  â”‚  â•²                     â”‚                      â”‚    â•²â•²
  â”‚   â•²                    â”‚                      â”‚      â•²â•²
  â”‚    â•²___                â”‚                      â”‚        â•²â•²___
  â”‚                        â”‚                      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Steps        â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Steps
                           â”‚
Converges faster           â”‚       Slower convergence, but...
Lower final loss on        â”‚       Better generalization!
  clean data               â”‚       Lower loss on noisy data!
                           â”‚
```

---

## ğŸ¯ Quick Decision Guide

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Which prob value should I use?                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚  Use prob=0.0 when:                                    â”‚
â”‚    â€¢ Training on very clean data                       â”‚
â”‚    â€¢ Testing baseline performance                      â”‚
â”‚    â€¢ Debugging other issues                            â”‚
â”‚                                                        â”‚
â”‚  Use prob=0.3-0.5 when:                               â”‚
â”‚    â€¢ General-purpose ASR                               â”‚
â”‚    â€¢ Balanced clean/noisy performance                  â”‚
â”‚    â€¢ Standard production models                        â”‚
â”‚                                                        â”‚
â”‚  Use prob=0.6-0.8 when:                               â”‚
â”‚    â€¢ Target deployment is noisy                        â”‚
â”‚    â€¢ Multi-speaker scenarios common                    â”‚
â”‚    â€¢ Robustness is critical                            â”‚
â”‚                                                        â”‚
â”‚  Use prob=1.0 when:                                    â”‚
â”‚    â€¢ Extremely noisy deployment                        â”‚
â”‚    â€¢ Clean data performance not critical               â”‚
â”‚    â€¢ Maximum robustness needed                         â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Debugging Checklist

```
âœ“ Verify augmentation is active:
  â””â”€ Check batch.audio != batch.noisy_audio

âœ“ Verify noise manifest loaded:
  â””â”€ Check train_ds.noise_manifest is not null
  â””â”€ Verify noise files exist

âœ“ Verify prob is correct:
  â””â”€ Expected augmented samples â‰ˆ batch_size * prob

âœ“ Verify SNR range reasonable:
  â””â”€ SNR too high â†’ almost no noise (no effect)
  â””â”€ SNR too low â†’ complete noise (too hard)

âœ“ Monitor training:
  â””â”€ Loss should be higher with augmentation initially
  â””â”€ Validation on noisy data should improve

âœ“ Test inference:
  â””â”€ Model should handle noise better
  â””â”€ WER on noisy test sets should decrease
```

---

## ğŸš€ Summary Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Batch Augmentation: The Big Picture              â”‚
â”‚                                                              â”‚
â”‚  Input: Clean speech batch                                   â”‚
â”‚    â”‚                                                         â”‚
â”‚    â”œâ”€â–º Sample 1 â”€â”¬â”€ prob=0.5 â”€â”¬â”€ YES â”€â”¬â”€ noise_ratio â”€â”¬â”€â†’ + Noise
â”‚    â”‚             â”‚             â”‚       â”‚                â”‚     â”‚
â”‚    â”‚             â”‚             â”‚       â”‚                â””â”€â†’ + Speaker
â”‚    â”‚             â”‚             â”‚       â”‚                      â”‚
â”‚    â”‚             â”‚             â””â”€ NO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Clean
â”‚    â”‚             â”‚                                           â”‚
â”‚    â”œâ”€â–º Sample 2 â”€â”¼â”€ ... (repeat for each sample)            â”‚
â”‚    â”‚             â”‚                                           â”‚
â”‚    â””â”€â–º Sample N â”€â”˜                                           â”‚
â”‚                                                              â”‚
â”‚  Output: Mixed batch with clean + augmented samples          â”‚
â”‚                                                              â”‚
â”‚  Result: Model learns robust representations! âœ…             â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**The `prob` parameter is your main control knob for augmentation intensity!** ğŸ›ï¸

Turn it up for robustness, turn it down for clean-data focus. ğŸ¯
