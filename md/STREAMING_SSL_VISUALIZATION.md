# ğŸ“Š Streaming SSL: Visual Guide

## ğŸ¯ Core Concept: Bidirectional vs Causal

### Non-Streaming (Bidirectional)
```
Audio Timeline:  [Past â†â€•â€•â€•â€•â€•â€•â€• Current â€•â€•â€•â€•â€•â†’ Future]
                    â†“           â†“         â†“
Encoder sees:    [â—â—â—â—â—â—â—â—â— Frame 50 â—â—â—â—â—â—â—â—â—]
                    â†‘           â†‘         â†‘
                  Uses        Current    Uses
                  past        frame     FUTURE
                  context               (not streaming!)

Problem: Cannot process in real-time - needs to see future!
```

### Streaming (Causal)
```
Audio Timeline:  [Past â†â€•â€•â€•â€•â€•â€•â€• Current | Future ?????]
                    â†“           â†“
Encoder sees:    [â—â—â—â—â—â—â—â—â— Frame 50 | xxxxxxxxx]
                    â†‘           â†‘         â†‘
                  Uses        Current    Cannot
                  past        frame     access
                  context               (streaming-safe!)

Benefit: Can process frame-by-frame in real-time!
```

---

## ğŸ§± Architecture Comparison

### Traditional NEST (Non-Streaming)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Input Audio                        â”‚
â”‚              [0  1  2  3  4  5  6  7]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Mel Spectrogram                         â”‚
â”‚         (Bidirectional Processing)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Random Block Masking                       â”‚
â”‚    Masks ANY frames: [M  âœ“  M  M  âœ“  M  âœ“  âœ“]     â”‚
â”‚         (Can mask past or future)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        FastConformer Encoder                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Self-Attention (Bidirectional)         â”‚       â”‚
â”‚  â”‚    â†â†â†â†â† Frame i â†’â†’â†’â†’â†’                  â”‚       â”‚
â”‚  â”‚  Sees: All past + All future frames     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Convolution (Bidirectional)            â”‚       â”‚
â”‚  â”‚    kernel = [..., -1, 0, +1, ...]       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  BatchNorm (Batch Statistics)           â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Decoder + Loss                         â”‚
â”‚    Predict masked tokens: [2047 âœ“ 156 8191...]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Latency: High (needs entire utterance)
Real-time: âŒ No
```

### Streaming NEST (Our Implementation)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Input Audio Stream                     â”‚
â”‚          [0  1  2  3  4 Â·Â·Â· ? ? ?]                 â”‚
â”‚           â†‘        â†‘  â†‘                             â”‚
â”‚          Past   Current  Future (unknown)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Mel Spectrogram (Causal)                    â”‚
â”‚       (Only uses current & past)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Causal Random Block Masking                 â”‚
â”‚   current_frame = 4                                 â”‚
â”‚   Masks ONLY past: [M  âœ“  M  M  ?  ?  ?  ?]       â”‚
â”‚                     â†‘        â†‘  â†‘                   â”‚
â”‚                  Can mask  Current Future           â”‚
â”‚                   (past)    (no   (never            â”‚
â”‚                            mask)  mask)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Causal FastConformer Encoder                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Self-Attention (Causal)                â”‚       â”‚
â”‚  â”‚    â†â†â†â†â† Frame i                        â”‚       â”‚
â”‚  â”‚  att_context_size: [-1, 0]              â”‚       â”‚
â”‚  â”‚  Sees: All past + NO future             â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Convolution (Causal)                   â”‚       â”‚
â”‚  â”‚    conv_context_size: 'causal'          â”‚       â”‚
â”‚  â”‚    kernel = [..., -2, -1, 0]            â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  LayerNorm (Per-Sample Statistics)      â”‚       â”‚
â”‚  â”‚  Critical for streaming consistency!    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Decoder + Loss                         â”‚
â”‚    Predict masked tokens (only past frames)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Latency: Low (~20-50ms)
Real-time: âœ… Yes!
```

---

## ğŸ­ Causal Masking Visualization

### Frame-by-Frame Processing

```
Time Step t=0:
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ 0  â”‚ ?  â”‚ ?  â”‚ ?  â”‚ ?  â”‚ ?  â”‚ ?  â”‚ ?  â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
 â†‘current
 â””â”€ Can mask: frame 0 only
    Process: frame 0

Time Step t=1:
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ 0  â”‚ 1  â”‚ ?  â”‚ ?  â”‚ ?  â”‚ ?  â”‚ ?  â”‚ ?  â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
      â†‘current
      â””â”€ Can mask: frames 0-1
         Process: frame 1

Time Step t=4:
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ 0  â”‚ 1  â”‚ 2  â”‚ 3  â”‚ 4  â”‚ ?  â”‚ ?  â”‚ ?  â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                â†‘current
                â””â”€ Can mask: frames 0-4
                   Process: frame 4

Time Step t=7:
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ 0  â”‚ 1  â”‚ 2  â”‚ 3  â”‚ 4  â”‚ 5  â”‚ 6  â”‚ 7  â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
                                    â†‘current
                                    â””â”€ Can mask: frames 0-7
                                       Process: frame 7
```

### Masking Window Example

```
Current Frame = 5, Left Context Size = unlimited (-1)

Timeline:
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ 0  â”‚ 1  â”‚ 2  â”‚ 3  â”‚ 4  â”‚ 5  â”‚ 6  â”‚ 7  â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
  M    âœ“    M    M    âœ“    âœ“    ?    ?
  â†‘                        â†‘    â†‘    â†‘
  Can be                Current Cannot
  masked                 (no    mask
  (past context)        mask)  (future)

M = Masked, âœ“ = Not masked, ? = Future (unknown)

Example Mask Pattern:
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ M  â”‚    â”‚ M  â”‚ M  â”‚    â”‚    â”‚    â”‚    â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
  â†‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†‘    â†‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â†‘
  Masking window           No masking zone
  (frames 0-5)             (future frames)
```

### With Limited Left Context

```
Current Frame = 10, Left Context Size = 5

Timeline:
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ 0 â”‚ 1 â”‚ 2 â”‚ 3 â”‚ 4 â”‚ 5 â”‚ 6 â”‚ 7 â”‚ 8 â”‚ 9 â”‚10 â”‚11 â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
  x   x   x   x   x   M   âœ“   M   M   âœ“   âœ“   ?
  â†‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†‘   â†‘â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†‘   â†‘   â†‘
  Too far past    Valid masking    Current Future
  (ignored)       window (5 frames)

Valid Context Window = [current - left_context, current]
                     = [10 - 5, 10]
                     = [5, 10]
```

---

## ğŸ” Attention Pattern Visualization

### Bidirectional Attention (Non-Streaming)
```
Attention Matrix (frame i can attend to frame j):

    Frames:  0  1  2  3  4  5  6  7
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        0  â”‚ â—  â—  â—  â—  â—  â—  â—  â—  â”‚
        1  â”‚ â—  â—  â—  â—  â—  â—  â—  â—  â”‚
        2  â”‚ â—  â—  â—  â—  â—  â—  â—  â—  â”‚
        3  â”‚ â—  â—  â—  â—  â—  â—  â—  â—  â”‚
        4  â”‚ â—  â—  â—  â—  â—  â—  â—  â—  â”‚  â† All frames
        5  â”‚ â—  â—  â—  â—  â—  â—  â—  â—  â”‚    can see
        6  â”‚ â—  â—  â—  â—  â—  â—  â—  â—  â”‚    all frames
        7  â”‚ â—  â—  â—  â—  â—  â—  â—  â—  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â— = Can attend (full matrix)

Problem: Frame 3 attends to frame 7 (future!)
Cannot do real-time processing!
```

### Causal Attention (Streaming - Fully Causal)
```
Attention Matrix (frame i can attend to frame j):

    Frames:  0  1  2  3  4  5  6  7
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        0  â”‚ â—  Â·  Â·  Â·  Â·  Â·  Â·  Â·  â”‚
        1  â”‚ â—  â—  Â·  Â·  Â·  Â·  Â·  Â·  â”‚
        2  â”‚ â—  â—  â—  Â·  Â·  Â·  Â·  Â·  â”‚
        3  â”‚ â—  â—  â—  â—  Â·  Â·  Â·  Â·  â”‚  â† Lower
        4  â”‚ â—  â—  â—  â—  â—  Â·  Â·  Â·  â”‚    triangular
        5  â”‚ â—  â—  â—  â—  â—  â—  Â·  Â·  â”‚    (causal!)
        6  â”‚ â—  â—  â—  â—  â—  â—  â—  Â·  â”‚
        7  â”‚ â—  â—  â—  â—  â—  â—  â—  â—  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â— = Can attend, Â· = Cannot attend (masked)

att_context_size: [-1, 0]
         unlimited â†‘  â†‘ no future
              past    context

âœ… Frame 3 only sees frames 0-3 (no future!)
âœ… Can process frame-by-frame in real-time!
```

### Causal with Limited Lookahead (40ms)
```
Attention Matrix (lookahead = 4 frames):

    Frames:  0  1  2  3  4  5  6  7
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        0  â”‚ â—  â—  â—  â—  â—  Â·  Â·  Â·  â”‚
        1  â”‚ â—  â—  â—  â—  â—  â—  Â·  Â·  â”‚
        2  â”‚ â—  â—  â—  â—  â—  â—  â—  Â·  â”‚
        3  â”‚ â—  â—  â—  â—  â—  â—  â—  â—  â”‚  â† Band
        4  â”‚ Â·  â—  â—  â—  â—  â—  â—  â—  â”‚    diagonal
        5  â”‚ Â·  Â·  â—  â—  â—  â—  â—  â—  â”‚    (lookahead)
        6  â”‚ Â·  Â·  Â·  â—  â—  â—  â—  â—  â”‚
        7  â”‚ Â·  Â·  Â·  Â·  â—  â—  â—  â—  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

att_context_size: [-1, 4]
         unlimited â†‘  â†‘ 4 frames
              past    lookahead

Latency: ~60ms (40ms lookahead + 20ms processing)
Benefit: Better accuracy than fully causal
```

### Limited Context Window (Memory-Efficient)
```
Attention Matrix (context window = 5 frames):

    Frames:  0  1  2  3  4  5  6  7
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        0  â”‚ â—  Â·  Â·  Â·  Â·  Â·  Â·  Â·  â”‚
        1  â”‚ â—  â—  Â·  Â·  Â·  Â·  Â·  Â·  â”‚
        2  â”‚ â—  â—  â—  Â·  Â·  Â·  Â·  Â·  â”‚
        3  â”‚ â—  â—  â—  â—  Â·  Â·  Â·  Â·  â”‚
        4  â”‚ â—  â—  â—  â—  â—  Â·  Â·  Â·  â”‚  â† Diagonal
        5  â”‚ Â·  â—  â—  â—  â—  â—  Â·  Â·  â”‚    band of
        6  â”‚ Â·  Â·  â—  â—  â—  â—  â—  Â·  â”‚    width 5
        7  â”‚ Â·  Â·  Â·  â—  â—  â—  â—  â—  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

att_context_size: [5, 0]
           5 past â†‘  â†‘ no future
             frames

Memory: O(context_window) per frame
Benefit: Bounded memory for long audio
```

---

## ğŸ”„ Training Flow

### Non-Streaming Training
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Clean Audio    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Mel Features    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Random Block Masking           â”‚
â”‚  (anywhere in sequence)          â”‚
â”‚                                  â”‚
â”‚  [0 1 2 3 4 5 6 7]              â”‚
â”‚   M âœ“ M M âœ“ M âœ“ âœ“               â”‚
â”‚   â†‘             â†‘               â”‚
â”‚   Can mask past & future        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Quantizer (Clean)              â”‚
â”‚   â†’ Target Tokens                â”‚
â”‚   [2047, 156, 8191, ...]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Bidirectional Encoder          â”‚
â”‚   (BatchNorm)                    â”‚
â”‚                                  â”‚
â”‚   Frame i sees:                  â”‚
â”‚   â†â†â†â† all past + all future â†’â†’â†’â†’â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Decoder                        â”‚
â”‚   â†’ Predicted Tokens             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Loss (on masked positions)     â”‚
â”‚   CrossEntropy(pred, target)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Streaming Training (Our Implementation)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Clean Audio    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Mel Features    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Causal Random Block Masking    â”‚
â”‚  (only past frames)              â”‚
â”‚                                  â”‚
â”‚  current_frame = 4               â”‚
â”‚  [0 1 2 3 4 5 6 7]              â”‚
â”‚   M âœ“ M M âœ“ ? ? ?               â”‚
â”‚   â†‘       â†‘ â†‘â”€â”€â”€â”€â”€â†‘             â”‚
â”‚   Past    â”‚ Future (no mask)    â”‚
â”‚   (can    â”‚                     â”‚
â”‚   mask)   Current (no mask)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Quantizer (Clean)              â”‚
â”‚   â†’ Target Tokens                â”‚
â”‚   [2047, 156, 8191, ...]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Causal Encoder                 â”‚
â”‚   (LayerNorm - Critical!)        â”‚
â”‚                                  â”‚
â”‚   Frame i sees:                  â”‚
â”‚   â†â†â†â† only past (no future)     â”‚
â”‚                                  â”‚
â”‚   att_context_size: [-1, 0]     â”‚
â”‚   conv_context_size: causal      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Decoder                        â”‚
â”‚   â†’ Predicted Tokens             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Loss (on masked past frames)   â”‚
â”‚   CrossEntropy(pred, target)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Key Differences:
âœ… Causal masking (only past)
âœ… Causal encoder (no future context)
âœ… LayerNorm (deterministic per-sample)
```

---

## ğŸ¬ Streaming Inference Flow

### Chunk-by-Chunk Processing

```
Audio Stream:  [â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’]

Chunk 1 (0.32s):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ â†’ Process â†’ Output 1
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Chunk 2 (0.32s):
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ â†’ Process â†’ Output 2
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Chunk 3 (0.32s):
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ â†’ Process â†’ Output 3
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Timeline:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Chunk 1 â”‚ Chunk 2 â”‚ Chunk 3 â”‚ Chunk 4 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“         â†“         â†“         â†“
  Output 1  Output 2  Output 3  Output 4

Each chunk processed independently!
No need to wait for future chunks!
```

### Context Handling

```
Fully Causal (att_context_size: [-1, 0]):

Chunk 1:     Chunk 2:         Chunk 3:
â”Œâ”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”
â”‚ A B â”‚      â”‚ C D â”‚          â”‚ E F â”‚
â””â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”˜

Processing:
A sees: [A]
B sees: [A, B]
C sees: [A, B, C]         â† Sees all past!
D sees: [A, B, C, D]
E sees: [A, B, C, D, E]
F sees: [A, B, C, D, E, F]

Context grows with each chunk!


Limited Context (att_context_size: [5, 0]):

Chunk 1:     Chunk 2:         Chunk 3:
â”Œâ”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”
â”‚ A B â”‚      â”‚ C D â”‚          â”‚ E F â”‚
â””â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”˜

Processing:
A sees: [A]
B sees: [A, B]
C sees: [A, B, C]
D sees: [A, B, C, D]
E sees: [B, C, D, E]       â† Only 5 frames!
F sees: [C, D, E, F]

Memory bounded by context window!
```

---

## ğŸ—ï¸ LayerNorm vs BatchNorm Impact

### Problem with BatchNorm in Streaming

```
Training (Batch of 4 utterances):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Utterance 1: [f1, f2, f3, f4]              â”‚
â”‚ Utterance 2: [f5, f6, f7, f8]              â”‚
â”‚ Utterance 3: [f9, f10, f11, f12]           â”‚
â”‚ Utterance 4: [f13, f14, f15, f16]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
        BatchNorm computes:
        mean = mean(f1...f16)      â† Across batch!
        std = std(f1...f16)

Inference (Single chunk):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Chunk: [f1, f2, f3, f4]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
        BatchNorm uses:
        mean = ??? (different from training!)
        std = ??? (different statistics!)

Result: âŒ Inconsistent outputs!
        Different chunk boundaries â†’ different statistics
```

### Solution: LayerNorm

```
Training (Batch of 4 utterances):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Utterance 1: [f1, f2, f3, f4]              â”‚
â”‚              â†“                               â”‚
â”‚    LayerNorm: mean(f1,f2,f3,f4)  â† Per sample!
â”‚                                              â”‚
â”‚ Utterance 2: [f5, f6, f7, f8]              â”‚
â”‚              â†“                               â”‚
â”‚    LayerNorm: mean(f5,f6,f7,f8)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Inference (Single chunk):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Chunk: [f1, f2, f3, f4]                     â”‚
â”‚        â†“                                     â”‚
â”‚ LayerNorm: mean(f1,f2,f3,f4)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Result: âœ… Consistent outputs!
        Same computation regardless of batch!
        Deterministic streaming inference!
```

---

## ğŸ“ˆ Performance Trade-offs

### Latency vs Accuracy

```
                Accuracy
                   â†‘
                   â”‚
    Bidirectional  â”‚  â—  (Best accuracy, high latency)
                   â”‚
                   â”‚
    40ms Lookahead â”‚      â—  (Good accuracy, medium latency)
                   â”‚
                   â”‚
    Fully Causal   â”‚          â—  (Good accuracy, low latency)
                   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Latency
                   0ms    50ms   100ms   200ms

Typical Results:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Configuration    â”‚ Latency  â”‚ WER      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Bidirectional    â”‚ Full utt â”‚ 5.0%     â”‚
â”‚ 40ms Lookahead   â”‚ ~60ms    â”‚ 5.5%     â”‚
â”‚ Fully Causal     â”‚ ~20ms    â”‚ 6.0%     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Memory Usage

```
Unlimited Context:
Memory per step: O(T) where T = total frames
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ â— â”‚ â— â”‚ â— â”‚ â— â”‚ â— â”‚ â— â”‚ â— â”‚ â— â”‚ â— â”‚ â— â”‚ ... grows!
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜

Limited Context (e.g., 320 frames):
Memory per step: O(C) where C = context size
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ â— â”‚ â— â”‚ â— â”‚ â— â”‚ â— â”‚ ... fixed!
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
  (oldest frames dropped)
```

---

## ğŸ¯ Configuration Examples

### Example 1: Real-Time Dictation
```yaml
# Ultra-low latency, reasonable accuracy
encoder:
  att_context_size: [-1, 0]      # No future
  conv_context_size: causal       # Causal conv
  conv_norm_type: layer_norm      # Streaming-safe
  causal_downsampling: true       # Causal subsampling

masking:
  causal: true                    # Causal masking
  left_context_size: -1           # Unlimited past

â†’ Latency: ~20ms
â†’ Use case: Live dictation, voice commands
```

### Example 2: Live Broadcast Captions
```yaml
# Balanced latency and accuracy
encoder:
  att_context_size: [-1, 4]      # 40ms lookahead
  conv_context_size: causal
  conv_norm_type: layer_norm
  causal_downsampling: true

masking:
  causal: true
  left_context_size: -1

â†’ Latency: ~60ms
â†’ Use case: Live TV, video calls
```

### Example 3: Podcast Transcription
```yaml
# Memory-efficient for long audio
encoder:
  att_context_size: [320, 0]     # 3.2s context
  conv_context_size: causal
  conv_norm_type: layer_norm
  causal_downsampling: true

masking:
  causal: true
  left_context_size: 320          # Match attention

â†’ Memory: Bounded
â†’ Use case: Long-form audio, streaming services
```

---

## ğŸ” Key Insights

### 1. Causality is Everywhere
```
âœ… Causal Masking    (only mask past)
âœ… Causal Attention  (only attend to past)
âœ… Causal Convolution (only use past frames)
âœ… Causal Downsampling (no future info)

If ANY component sees future â†’ NOT streaming!
```

### 2. Normalization Matters
```
âŒ BatchNorm â†’ Batch-dependent statistics
âœ… LayerNorm â†’ Per-sample statistics

For streaming: ALWAYS use LayerNorm!
```

### 3. Context Size Trade-off
```
Large context  â†’ Better accuracy, more memory
Small context  â†’ Lower memory, slight accuracy drop
Lookahead      â†’ Better accuracy, higher latency
```

---

## ğŸš€ Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Streaming SSL: The Big Picture                 â”‚
â”‚                                                        â”‚
â”‚  Traditional:  [Past â†â€•â€•â€•â€• Now â€•â€•â€•â€•â†’ Future]          â”‚
â”‚                        Uses ALL                        â”‚
â”‚                   âŒ Cannot stream                     â”‚
â”‚                                                        â”‚
â”‚  Streaming:    [Past â†â€•â€•â€•â€• Now | ?????]               â”‚
â”‚                    Uses ONLY past                      â”‚
â”‚                   âœ… Real-time ready!                  â”‚
â”‚                                                        â”‚
â”‚  Key Components:                                       â”‚
â”‚    â€¢ Causal Masking (only mask past)                  â”‚
â”‚    â€¢ Causal Attention (no future context)             â”‚
â”‚    â€¢ LayerNorm (deterministic)                        â”‚
â”‚    â€¢ Causal Convolutions                              â”‚
â”‚                                                        â”‚
â”‚  Result: Low-latency ASR with strong SSL pretraining! â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Ready to train? See `QUICK_START_STREAMING.md` to begin!** ğŸ‰
